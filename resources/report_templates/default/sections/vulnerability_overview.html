{% load markdown %}
{% load vulns %}

<article id="vulnerability" class="chapter">
    <h1 class="chapter-title" id="vulnerability-title">Vulnerability Overview</h1>
</article>

<article id="vulnerbilities-list" class="page-content">
    <section>
        <h2>Vulnerability Risk Definition and Criteria</h2>

        <p>
            The risk ratings assigned to each vulnerability are determined by averaging several aspects of the exploit
            and the environment, including reputation, difficulty,
            and criticality.
        </p>
        <table class="table-bordered">
            <tr>
                <th class="text-critical">Critical</th>
                <td>
                    Critical vulnerabilities pose a serious threat to an organization's security, and should be fixed
                    immediately.
                    They may provide a total compromise of the target environment, or similar critical impacts.
                </td>
            </tr>
            <tr>
                <th class="text-high">High</th>
                <td>
                    High risk vulnerabilities provide a serious risk to the company environment and should
                    be corrected promptly. These issues can significantly affect the organization's security
                    posture.
                </td>
            </tr>
            <tr>
                <th class="text-medium">Medium</th>
                <td>
                    Medium severity vulnerabilities represent a moderate risk to the environment. They may
                    require additional context before remediation but should be remediated after critical
                    and high risks.
                </td>
            </tr>
            <tr>
                <th class="text-low">Low</th>
                <td>
                    Low severity vulnerabilities provide minimal risk to the target environment, and often
                    theoretical in nature. Remediation of low risks is often a lower priority than other
                    security hardening techniques.
                </td>
            </tr>
            <tr>
                <th class="text-informational">Informational</th>
                <td>
                    Informational vulnerabilities have little-or-no impact to the target scope by themselves.
                    They are included however, as they may be a risk when combined with other
                    circumstances or technologies not currently in place. Remediation of informational items
                    is not necessary.
                </td>
            </tr>
        </table>
    </section>
    <div class="page-break"></div>

    <section>
        <h2>Vulnerability Categories</h2>
        <p>
            The vulnerabilities found were divided into categories.
            These provide an overview of the area in which the most errors were found.
        </p>
        <p>
            In the case of clear deflections, consideration should be given to appropriate countermeasures in these areas.
        </p>
        <img src="{{ CATEGORY_POLAR_CHART }}" alt="category-chart" style="width: 10cm; max-width: 15cm; height:7cm; margin-left:auto;margin-right:auto; display:block">

    </section>

    <section>
        <h2>Vulnerabilities by Risk Level</h2>
        <p>
            The following vulnerabilities were found within each risk level.
        </p>

        <img src="{{ SEVERITY_CHART_SRC }}" alt="severity-chart" style="width: 8cm; max-width: 8cm; height:8cm; margin-left:auto;margin-right:auto; display:block">
    </section>
    <div class="page-break"></div>

    <section>
        <h2>Vulnerabilities</h2>

        <p>The following table lists the vulnerabilities found in order of their criticality.</p>

        <table class="table-bordered">
            <thead>
            <tr>
                <th>Vulnerability</th>
                <th>Findings</th>
                <th>Risk Level</th>
            </tr>
            </thead>
            <tbody>
                {% for template in templates %}
                    <tr>
                        <td><a href="#template-{{ template.pk }}">{{template.name}}</a></td>
                        <td>{{template|get_vulns_for_project:project|length}}</td>
                        <td>
                            <span class="fa-layers text-{{ template.get_risk_level|lower }}">
                                <i class="fas fa-bookmark"></i>
                                <span class="fa-layers-text" data-fa-transform="shrink-8 down-3" style="font-weight:900">{{ template.get_risk_level|capfirst }}</span>
                            </span>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </section>
</article>
