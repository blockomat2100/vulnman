from api.v1 import generics
from api.v1.serializers import vulnerability as serializers
from apps.findings import models


class AgentVulnerabilityViewSet(generics.AgentModelViewSet):
    queryset = models.Vulnerability.objects.all()
    search_fields = ["name", "template__vulnerability_id"]
    serializer_class = serializers.VulnerabilitySerializer


class AgentTextProofViewSet(generics.AgentModelViewSet):
    queryset = models.TextProof.objects.all()
    search_fields = ["name", "description", "text"]
    serializer_class = serializers.TextProofSerializer
