{% load markdown %}
<section>
    <h3>{{ vulnerability.name }}</h3>

    <table class="table-bordered">
        <tr>
            <th>Severity</th>
            <td>{{ vulnerability.cvss_score }} ({{ vulnerability.get_severities.0 }})</td>
        </tr>
        <tr>
            <th>Affected Component</th>
            {% if vulnerability.service %}
            <td>{{ vulnerability.service.host }}:{{ vulnerability.service.port }}</td>
            {% else %}
            <td>{{ vulnerability.host }}</td>
            {% endif %}
        </tr>
        <tr>
            <th>Ease of Resolution</th>
            <td>{{ vulnerability.get_ease_of_resolution_display }}</td>
        </tr>
        {% if vulnerability.vulnerabilitydetails.path %}
        <tr>
            <th>Path</th>
            <td>{{ vulnerability.vulnerabilitydetails.path }}</td>
        </tr>
        {% endif %}
        {% if vulnerability.vulnerabilitydetails.parameter %}
        <tr>
            <th>Parameter</th>
            <td>{{ vulnerability.vulnerabilitydetails.parameter }}</td>
        </tr>
        {% endif %}
        {% if vulnerability.vulnerabilitydetails.site %}
        <tr>
            <th>Site</th>
            <td>{{ vulnerability.vulnerabilitydetails.site }}</td>
        </tr>
        {% endif %}
    </table>

    <section>
        <h4>Description</h4>
        <p>
            {{ vulnerability.description|md_to_html }}
        </p>
    </section>
    <section>
        <h4>Details</h4>
        <p>{{ vulnerability.vulnerabilitydetails.data|md_to_html }}</p>
    </section>
    <section>
        <h4>Resolution</h4>
        <p>{{ vulnerability.resolution|md_to_html }}</p>
    </section>
    <section>
        <h4>Steps to reproduce</h4>
        <p>TODO: implement</p>
    </section>
</section>