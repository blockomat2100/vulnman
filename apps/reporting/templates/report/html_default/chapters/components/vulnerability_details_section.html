{% load markdown %}
<section id="vuln-{{ vulnerability.pk }}">
    <h3>{{ vulnerability.template.name }}</h3>

    <table class="table-bordered">
        <tr>
            <th>Severity</th>
            <td>{{ vulnerability.cvss_score }} ({{ vulnerability.get_severities.0 }})</td>
        </tr>
        <tr>
            <th>Affected Component</th>
            {% if vulnerability.service %}
            <td>{{ vulnerability.service.host }}:{{ vulnerability.service.port }}</td>
            {% else %}
            <td>{{ vulnerability.host }}</td>
            {% endif %}
        </tr>
        <tr>
            <th>Ease of Resolution</th>
            <td>{{ vulnerability.template.get_ease_of_resolution_display }}</td>
        </tr>
        {% if vulnerability.path %}
        <tr>
            <th>Path</th>
            <td>{{ vulnerability.path }}</td>
        </tr>
        {% endif %}
        {% if vulnerability.parameter %}
        <tr>
            <th>Parameter</th>
            <td>{{ vulnerability.parameter }}</td>
        </tr>
        {% endif %}
        {% if vulnerability.site %}
        <tr>
            <th>Site</th>
            <td>{{ vulnerability.site }}</td>
        </tr>
        {% endif %}
    </table>

    <section>
        <h4>Description</h4>
        <p>
            {{ vulnerability.template.description|md_to_html }}
        </p>
    </section>
    <section>
        <h4>Details</h4>
        <p>{{ vulnerability.details|md_to_html }}</p>
    </section>
    <section>
        <h4>Resolution</h4>
        <p>{{ vulnerability.template.resolution|md_to_html }}</p>
    </section>
    <section>
        <h4>Steps to reproduce</h4>
        {% for proof in vulnerability.proofofconcept_set.all %}
            {% if proof.description %}
                {{ proof.description|md_to_html }}
            {% endif %}
        {% endfor %}
    </section>
</section>